%% this ugliness makes cp calcs and whatever
clear all
close all
clc

N2 = [175	1.039
200	1.039
225	1.039
250	1.039
275	1.039
300	1.040
325	1.040
350	1.041
375	1.042
400	1.044
450	1.049
500	1.056
550	1.065
600	1.075
650	1.086
700	1.098
750	1.110
800	1.122
850	1.134
900	1.146
950	1.157
1000	1.167
1050	1.177
1100	1.187
1150	1.196
1200	1.204
1250	1.212
1300	1.219
1350	1.226
1400	1.232
1500	1.244
1600	1.254
1700	1.263
1800	1.271
1900	1.278
2000	1.284
2100	1.290
2200	1.295
2300	1.300
2400	1.304
2500	1.307
2600	1.311
2700	1.314
2800	1.317
2900	1.320
3000	1.323
3500	1.333
4000	1.342
4500	1.349
5000	1.355
5500	1.362
6000	1.369]

CO2 = [175	0.709
200	0.735
225	0.763
250	0.791
275	0.819
300	0.846
325	0.871
350	0.895
375	0.918
400	0.939
450	0.978
500	1.014
550	1.046
600	1.075
650	1.102
700	1.126
750	1.148
800	1.168
850	1.187
900	1.204
950	1.220
1000	1.234
1050	1.247
1100	1.259
1150	1.270
1200	1.280
1250	1.290
1300	1.298
1350	1.306
1400	1.313
1500	1.326
1600	1.338
1700	1.348
1800	1.356
1900	1.364
2000	1.371
2100	1.377
2200	1.383
2300	1.388
2400	1.393
2500	1.397
2600	1.401
2700	1.404
2800	1.408
2900	1.411
3000	1.414
3500	1.427
4000	1.437
4500	1.446
5000	1.455
5500	1.465
6000	1.476]

CO = [175	1.039
200	1.039
225	1.039
250	1.039
275	1.040
300	1.040
325	1.041
350	1.043
375	1.045
400	1.048
450	1.054
500	1.064
550	1.075
600	1.087
650	1.100
700	1.113
750	1.126
800	1.139
850	1.151
900	1.163
950	1.174
1000	1.185
1050	1.194
1100	1.203
1150	1.212
1200	1.220
1250	1.227
1300	1.234
1350	1.240
1400	1.246
1500	1.257
1600	1.267
1700	1.275
1800	1.282
1900	1.288
2000	1.294
2100	1.299
2200	1.304
2300	1.308
2400	1.311
2500	1.315
2600	1.318
2700	1.321
2800	1.324
2900	1.326
3000	1.329
3500	1.339
4000	1.346
4500	1.353
5000	1.359
5500	1.365
6000	1.370]

H2 = [175	13.12
200	13.53
225	13.83
250	14.05
275	14.20
300	14.31
325	14.38
350	14.43
375	14.46
400	14.48
450	14.50
500	14.51
550	14.53
600	14.55
650	14.57
700	14.60
750	14.65
800	14.71
850	14.77
900	14.83
950	14.90
1000	14.98
1050	15.06
1100	15.15
1150	15.25
1200	15.34
1250	15.44
1300	15.54
1350	15.65
1400	15.77
1500	16.02
1600	16.23
1700	16.44
1800	16.64
1900	16.83
2000	17.01
2100	17.18
2200	17.35
2300	17.50
2400	17.65
2500	17.80
2600	17.93
2700	18.06
2800	18.17
2900	18.28
3000	18.39
3500	18.91
4000	19.39
4500	19.83
5000	20.23
5500	20.61
6000	20.96]

H2O = [175	1.850
200	1.851
225	1.852
250	1.855
275	1.859
300	1.864
325	1.871
350	1.880
375	1.890
400	1.901
450	1.926
500	1.954
550	1.984
600	2.015
650	2.047
700	2.080
750	2.113
800	2.147
850	2.182
900	2.217
950	2.252
1000	2.288
1050	2.323
1100	2.358
1150	2.392
1200	2.425
1250	2.458
1300	2.490
1350	2.521
1400	2.552
1500	2.609
1600	2.662
1700	2.711
1800	2.756
1900	2.798
2000	2.836
2100	2.872
2200	2.904
2300	2.934
2400	2.962
2500	2.987
2600	3.011
2700	3.033
2800	3.053
2900	3.072
3000	3.090
3500	3.163
4000	3.217
4500	3.258
5000	3.292
5500	3.322
6000	3.350]

D = cat(3,CO,CO2,H2,H2O,N2); % (kJ/(kg K))

n = length(D);
m = 5;

Tc = linspace(200,6000,1000) %K
figure
hold on

MM = [28.01,44.01,2.016,18.01528,28.02] % g/mol
MM = MM./1000 %kg/mol

for i = 1:m
    D(:,2,i) = D(:,2,i).*MM(i); % kJ/(mol K)
end

for i = 1:m
    i
    p = spline(D(:,1,i),D(:,2,i));
    plot(Tc,ppval(p,Tc))
    scatter(D(:,1,i),D(:,2,i),".")
    p = fnint(p);
    P{i} = p;
end

labels = ["CO","CO","CO2","CO2","H2","H2","H2O","H2O","N2","N2"]
legend(labels)

save("IntegralOfCp.mat","P")

